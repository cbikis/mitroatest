import{a as B}from"./countriesStore-DlzkWG2V.js";import{_ as E,r as d,k as y,l as O,o as S,v as A,d as i,e as c,f as g,n as f,t as h,F as T,q as L,j as z,E as N}from"./app-C4nfOcqx.js";const U={key:0,class:"absolute z-10 left-1/2 transform -translate-x-1/2 w-auto min-w-full bg-white border border-sky-600 rounded-md shadow-lg max-h-60 overflow-y-auto overflow-x-hidden mt-1"},q=["onClick"],F={__name:"CustomDropdown",props:{options:Array,widthClass:{type:String,default:"w-full"},optionValue:String,optionText:String,modelValue:[String,Number],placeholder:String,required:Boolean,readOnly:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(r,{emit:k}){const C=B();let p;const t=r,x=k,l=d(!1),u=d(null),a=d(""),o=d(-1),b=y(()=>{const e=t.options.find(n=>n[t.optionValue]===t.modelValue);return e?e[t.optionText]:t.placeholder}),v=y(()=>t.options.filter(e=>e[t.optionText].toLowerCase().includes(a.value.toLowerCase()))),D=e=>{if(console.log("toggle dropdown"),console.log(t),t.readOnly){console.log("read only trueeeeeeeeeeeeeee"),e.preventDefault();return}l.value=!l.value,l.value?N(()=>{u.value.focus()}):(a.value="",o.value=-1)},w=e=>{x("update:modelValue",e[t.optionValue]),l.value=!1,a.value="",o.value=-1},m=e=>{u.value&&!u.value.contains(e.target)&&(l.value=!1,a.value="",o.value=-1)};O(()=>{window.addEventListener("click",m),p=new BroadcastChannel("new_country"),p.onmessage=e=>{if(e.data.type==="ADD_COUNTRY"){const n=e.data.payload;C.addCountry(n)}}}),S(()=>{window.removeEventListener("click",m),p.close()});const _=e=>{if(e.key==="Escape"){l.value=!1,a.value="",o.value=-1;return}if(e.key==="ArrowDown"||e.key==="ArrowUp"){e.preventDefault();const n=v.value.length,s=e.key==="ArrowDown"?1:-1;o.value=(o.value+s+n)%n;return}if(e.key==="Backspace"){e.preventDefault(),a.value.length>0&&(a.value=a.value.slice(0,-1),o.value=0);return}e.key.length===1&&/[a-zA-Z0-9-_.+?!*$']/.test(e.key)&&(a.value+=e.key.toLowerCase(),o.value=0),e.key==="Enter"&&o.value>=0&&w(v.value[o.value])};return A(a,(e,n)=>{e!==n&&e!==""&&(o.value=0)}),(e,n)=>(i(),c("div",{class:f(["text-black relative",r.widthClass]),ref_key:"dropdownElement",ref:u,onKeydown:_,tabindex:"0"},[g("div",{onClick:D,class:"cursor-pointer"},[g("div",{class:f(["block appearance-none w-full bg-white border border-gray-300 py-2 px-3 pr-8 rounded leading-tight focus:outline-none custom-blue-style",[r.widthClass,{"rounded-t-md":l.value,"rounded-md":!l.value}]])},h(b.value),3)]),l.value?(i(),c("div",U,[(i(!0),c(T,null,L(v.value,(s,V)=>(i(),c("div",{key:s[r.optionValue],onClick:I=>w(s),class:f([{"py-2 px-3 hover:bg-zinc-300 cursor-pointer whitespace-nowrap":!0,"bg-gray-400":V===o.value},"dropdown-option custom-blue-style"])},h(s[r.optionText]),11,q))),128))])):z("",!0)],34))}},j=E(F,[["__scopeId","data-v-fdce6ee0"]]);export{j as C};
