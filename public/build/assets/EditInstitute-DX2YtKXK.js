import{a as O,D as U,k as b,B as V,r as y,l as C,d as E,e as $,f as e,p as I,t as l,h as S,g,x as u,y as r,C as N}from"./app-C4nfOcqx.js";import{a as M,u as q}from"./countriesStore-DlzkWG2V.js";import{C as B}from"./CustomDropdown-iE1I-pk4.js";import{_ as D}from"./Popup-BAEILLfG.js";const j={class:"flex justify-center mt-12 text-blue-950"},F={class:"flex flex-col justify-center items-center bg-[#c4dff6] rounded-xl p-3 mt-28 border-2 border-sky-400 max-w-2xl w-full"},T={class:"flex flex-wraptext-gray-700 mt-2 self-start px-3"},P=e("i",{class:"fas fa-info-circle",style:{"margin-right":"0.5rem"}},null,-1),R=e("hr",{class:"border-t border-white w-full my-4 px-3"},null,-1),z={class:"mb-4"},A={for:"new_country_id",class:"block text-sm font-medium mb-1"},G={class:"mb-4 w-full"},H={for:"new_institute",class:"block text-sm font-medium"},J={class:"mb-4 w-full"},K={for:"new_institute_original",class:"block text-sm font-medium"},L={class:"mb-4 w-full"},Q={for:"new_institute_el",class:"block text-sm font-medium"},W={class:"mb-4 w-full"},X={for:"new_institute_old_1",class:"block text-sm font-medium"},Y={class:"mb-4 w-full"},Z={for:"new_institute_old_2",class:"block text-sm font-medium"},tt={class:"mb-4 w-full"},et={for:"new_url",class:"block text-sm font-medium"},st={class:"mb-4 w-full"},nt={for:"info",class:"block text-sm font-medium"},it={class:"mb-6 self-center"},ot={for:"franchise",class:"flex items-center"},lt={class:"ml-2 text-sm"},ut={class:"px-4 py-2 bg-[#77b6ea] rounded-md hover:bg-sky-500 self-end",type:"submit"},rt=e("i",{class:"fas fa-save",style:{"margin-right":"0.5rem"}},null,-1),mt={__name:"EditInstitute",setup(dt){const{t:a}=O(),c=U(),m=M(),d=q(),x=b(()=>m.countries),t=V({institute_id:Number(c.params.id),newCountryId:Number(c.query.country),newInstitute:c.query.institute,newUrl:"",newInstituteOriginal:"",newInstituteEl:"",newInstituteOld1:"",newInstituteOld2:"",info:c.query.info,franchise:c.query.franchise==="1"}),w=y(!1),p=y(null),h=b(()=>{switch(p.value){case"emptyInstituteInput":return a("please_input_institite_name");case"sameInstituteInput":return a("same_institute_already_exists");case"details_updated_successfully":return a("details_updated_successfully");case"problem_updating_details":return a("error_submitting_form");case"error":return a("error_submitting_form");default:return""}});C(async()=>{m.fetchCountries(),await d.fetchInstitutes();const n=d.institutes.filter(s=>s.country_id===t.newCountryId&&s.institute===t.newInstitute)[0];console.log(n),n&&(t.newUrl=n.url,t.newInstituteOriginal=n.institute_original,t.newInstituteEl=n.institute_el,t.newInstituteOld1=n.institute_old_1,t.newInstituteOld2=n.institute_old_2)});const k=async()=>{if(d.institutes.filter(o=>o.country_id===t.newCountryId).some(o=>o.institute===t.newInstitute&&o.franchise==t.franchise&&o.info===t.info&&o.url===t.newUrl&&o.institute_original===t.newInstituteOriginal&&o.institute_el===t.newInstituteEl&&o.institute_old_1===t.newInstituteOld1&&o.institute_old_2===t.newInstituteOld2)){f("sameInstituteInput");return}const s={};if(t.newCountryId&&(s.newCountryId=t.newCountryId),t.newInstitute)s.newInstitute=t.newInstitute;else if(t.newInstitute=""){f("emptyInstituteInput");return}t.info?s.info=t.info:t.info||(s.info=""),s.newUrl=t.newUrl?t.newUrl:"",s.newInstituteOriginal=t.newInstituteOriginal?t.newInstituteOriginal:"",s.newInstituteEl=t.newInstituteEl?t.newInstituteEl:"",s.newInstituteOld1=t.newInstituteOld1?t.newInstituteOld1:"",s.newInstituteOld2=t.newInstituteOld2?t.newInstituteOld2:"",console.log(t.info),s.franchise=t.franchise;try{const o=await d.editInstitute(t,s);if(o&&o.status===200){const _=o.data,v=m.getCountryNameById(_.country_id);_.country=v,d.updateInstitute(_),d.broadcastEdit(_),f("details_updated_successfully")}else f("problem_updating_details")}catch(o){console.error("Υπήρξε σφάλμα στην αποστολή της φόρμας",o),f("error")}},f=i=>{p.value=i,w.value=!0};return(i,n)=>(E(),$("div",j,[e("div",F,[e("div",T,[e("div",null,[P,I(" "+l(i.$t("update_institute_details")),1)])]),e("form",{onSubmit:S(k,["prevent"]),class:"flex flex-col justify-center gap-3 w-full px-3"},[R,e("div",z,[e("label",A,l(i.$t("add_institute_form_country")),1),g(B,{id:"new_country_id",options:x.value,"option-value":"id","option-text":"country",modelValue:t.newCountryId,"onUpdate:modelValue":n[0]||(n[0]=s=>t.newCountryId=s),placeholder:i.$t("choose_country"),required:""},null,8,["options","modelValue","placeholder"])]),e("div",G,[e("label",H,l(i.$t("add_institute_form_institute")),1),u(e("input",{id:"new_institute","onUpdate:modelValue":n[1]||(n[1]=s=>t.newInstitute=s),type:"text",class:"mt-1 block w-full py-2 px-3 text-blue-950 border border-sky-400 bg-gray-200 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500"},null,512),[[r,t.newInstitute]])]),e("div",J,[e("label",K,l(i.$t("add_institute_form_institute_original")),1),u(e("input",{id:"new_institute_original","onUpdate:modelValue":n[2]||(n[2]=s=>t.newInstituteOriginal=s),type:"text",class:"mt-1 block w-full py-2 px-3 text-blue-950 border border-sky-400 bg-gray-200 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500"},null,512),[[r,t.newInstituteOriginal]])]),e("div",L,[e("label",Q,l(i.$t("add_institute_form_institute_el")),1),u(e("input",{id:"new_institute_el","onUpdate:modelValue":n[3]||(n[3]=s=>t.newInstituteEl=s),type:"text",class:"mt-1 block w-full py-2 px-3 text-blue-950 border border-sky-400 bg-gray-200 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500"},null,512),[[r,t.newInstituteEl]])]),e("div",W,[e("label",X,l(i.$t("add_institute_form_institute_old_institute_1")),1),u(e("input",{id:"new_institute_old_1","onUpdate:modelValue":n[4]||(n[4]=s=>t.newInstituteOld1=s),type:"text",class:"mt-1 block w-full py-2 px-3 text-blue-950 border border-sky-400 bg-gray-200 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500"},null,512),[[r,t.newInstituteOld1]])]),e("div",Y,[e("label",Z,l(i.$t("add_institute_form_institute_old_institute_2")),1),u(e("input",{id:"new_institute_old_2","onUpdate:modelValue":n[5]||(n[5]=s=>t.newInstituteOld2=s),type:"text",class:"mt-1 block w-full py-2 px-3 text-blue-950 border border-sky-400 bg-gray-200 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500"},null,512),[[r,t.newInstituteOld2]])]),e("div",tt,[e("label",et,l(i.$t("add_institute_form_institute_url")),1),u(e("input",{id:"new_url","onUpdate:modelValue":n[6]||(n[6]=s=>t.newUrl=s),type:"text",class:"mt-1 block w-full py-2 px-3 text-blue-950 border border-sky-400 bg-gray-200 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500"},null,512),[[r,t.newUrl]])]),e("div",st,[e("label",nt,l(i.$t("add_institute_form_information")),1),u(e("input",{id:"info","onUpdate:modelValue":n[7]||(n[7]=s=>t.info=s),type:"text",class:"mt-1 block w-full py-2 px-3 text-blue-950 border border-sky-400 bg-gray-200 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-gray-500"},null,512),[[r,t.info]])]),e("div",it,[e("label",ot,[u(e("input",{id:"franchise","onUpdate:modelValue":n[8]||(n[8]=s=>t.franchise=s),type:"checkbox",class:"h-4 w-4 rounded"},null,512),[[N,t.franchise]]),e("span",lt,l(i.$t("add_institute_form_franchise")),1)])]),e("button",ut,[rt,I(" "+l(i.$t("save")),1)])],32)]),g(D,{message:h.value,isVisible:w.value,"onUpdate:isVisible":n[9]||(n[9]=s=>w.value=s)},null,8,["message","isVisible"])]))}};export{mt as default};
