import{a as V,D as U,k as _,B as I,r as b,l as N,d as E,e as S,f as t,p as w,t as d,h as q,i as c,g as x,x as T,y as v}from"./app-C4nfOcqx.js";import{a as B,b as M}from"./countriesStore-DlzkWG2V.js";import{C as D}from"./CustomDropdown-iE1I-pk4.js";import{_ as j}from"./Popup-BAEILLfG.js";const F={class:"flex justify-center mt-12 text-blue-950"},$={class:"flex flex-col justify-center items-center bg-[#c4dff6] rounded-xl p-3 mt-28 border-2 border-sky-400 max-w-2xl w-full"},P={class:"flex flex-wrap text-blue-950 mt-2 self-start px-3"},R=t("i",{class:"fas fa-info-circle",style:{"margin-right":"0.5rem"}},null,-1),z=t("hr",{class:"border-t border-sky-400 w-full my-4 px-3"},null,-1),A={class:"mb-4"},G={for:"new_country_id",class:"block text-sm font-medium mb-1"},H={class:"mb-4"},J={for:"new_title",class:"block text-sm font-medium text-blue-950"},K={class:"mb-4"},L={for:"title_type",class:"block text-sm font-medium"},O={class:"px-4 py-2 bg-[#77b6ea] rounded-md hover:bg-sky-500 self-end",type:"submit"},Q=t("i",{class:"fas fa-save",style:{"margin-right":"0.5rem"}},null,-1),se={__name:"EditTitle",setup(W){const{t:l}=V(),a=U(),m=B(),g=_(()=>m.countries),p=M(),e=I({title_id:Number(a.params.id),newCountryId:Number(a.query.country),newTitle:a.query.title,newTitleType:a.query.title_type,info:a.query.info}),r=b(!1),n=b(null),h=_(()=>{switch(n.value){case"empty_title":return l("edit_title_form_empty_title");case"empty_title_type":return l("edit_title_form_empty_title_type");case"details_updated_successfully":return l("details_updated_successfully");case"error":return l("error_submitting_form");default:return""}});N(async()=>{m.fetchCountries()});const k=async()=>{const y=e.newTitle.toUpperCase().trim(),s=e.newTitleType.toUpperCase().trim(),i=e.info.toUpperCase().trim();if(p.titles.find(o=>o.country_id===e.newCountryId&&o.title.toUpperCase().trim()===y&&o.title_type.toUpperCase().trim()===s&&o.info===i)){n.value="countryExists",r.value=!0;return}const u={};if(e.newCountryId&&(u.country_id=e.newCountryId),e.newTitle)u.title=e.newTitle;else if(!e.newTitle){n.value="empty_title",r.value=!0;return}if(e.newTitleType)u.title_type=e.newTitleType;else if(!e.newTitleType){n.value="empty_title_type",r.value=!0;return}e.info?u.info=e.info:e.info||(u.info="");try{const o=await p.editTitle(e,u);if(o&&o.status===200){const f=o.data,C=m.getCountryNameById(f.country_id);f.country=C,p.updateTitle(f),p.broadcastEdit(f),n.value="details_updated_successfully",r.value=!0}else n.value="error",r.value=!0}catch(o){console.error("Υπήρξε σφάλμα στην αποστολή της φόρμας",o),n.value="error",r.value=!0}};return(y,s)=>(E(),S("div",F,[t("div",$,[t("div",P,[t("div",null,[R,w(" "+d(y.$t("update_title_details")),1)])]),t("form",{onSubmit:q(k,["prevent"]),class:"flex flex-col justify-center gap-3 w-full px-3"},[z,t("div",A,[t("label",G,d(c(l)("add_title_form_country")),1),x(D,{id:"new_country_id",options:g.value,"option-value":"id","option-text":"country",modelValue:e.newCountryId,"onUpdate:modelValue":s[0]||(s[0]=i=>e.newCountryId=i),placeholder:c(l)("choose_country"),required:""},null,8,["options","modelValue","placeholder"])]),t("div",H,[t("label",J,d(c(l)("add_title_form_title")),1),T(t("input",{id:"new_title","onUpdate:modelValue":s[1]||(s[1]=i=>e.newTitle=i),type:"text",class:"mt-1 block w-full py-2 px-3 border border-sky-400 bg-gray-200 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500"},null,512),[[v,e.newTitle]])]),t("div",K,[t("label",L,d(c(l)("add_title_form_title_type")),1),T(t("input",{id:"title_type","onUpdate:modelValue":s[2]||(s[2]=i=>e.newTitleType=i),type:"text",class:"mt-1 block w-full py-2 px-3 text-blue-950 border border-sky-400 bg-gray-200 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500"},null,512),[[v,e.newTitleType]])]),t("button",O,[Q,w(" "+d(c(l)("save")),1)])],32)]),x(j,{message:h.value,isVisible:r.value,"onUpdate:isVisible":s[3]||(s[3]=i=>r.value=i)},null,8,["message","isVisible"])]))}};export{se as default};
