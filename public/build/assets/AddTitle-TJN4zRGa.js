import{a as I,k as c,B as C,r as f,l as V,d as S,e as U,f as t,p as b,t as a,i as u,h as N,g as v,x as p,y as _,A as D}from"./app-C4nfOcqx.js";import{a as E,b as M}from"./countriesStore-DlzkWG2V.js";import{_ as z}from"./Popup-BAEILLfG.js";import{C as A}from"./CustomDropdown-iE1I-pk4.js";const B={class:"flex justify-center mt-12 text-blue-950"},j={class:"flex flex-col justify-center items-center bg-[#c4dff6] rounded-xl p-3 mt-28 border-2 border-sky-400 max-w-2xl w-full"},F={class:"flex flex-wraptext-gray-700 mt-2 self-start px-3"},L=t("i",{class:"fas fa-info-circle",style:{"margin-right":"0.5rem"}},null,-1),q=t("hr",{class:"border-t border-white w-full my-4 px-3"},null,-1),P={class:"mb-4"},$={for:"country_id_title",class:"block text-sm font-medium mb-1"},G={class:"mb-4"},H={for:"title",class:"block text-sm font-medium"},J={class:"mb-4"},K={for:"title_type",class:"block text-sm font-medium"},O={class:"mb-4"},Q={for:"info_title",class:"block text-sm font-medium"},R={class:"px-4 py-2 bg-[#77b6ea] rounded-md hover:bg-sky-500 self-end",type:"submit"},W=t("i",{class:"fas fa-save",style:{"margin-right":"0.5rem"}},null,-1),se={__name:"AddTitle",setup(X){const{t:s}=I(),x=c(()=>y.countries),g=c(()=>d.titles),y=E(),d=M(),e=C({country_id:"",title:"",title_type:"",info:""}),l=f(!1),i=f(null),h=c(()=>{switch(i.value){case"emptyInput":return s("please_select_country_title_and_type");case"emptyCountryTitleInput":return s("please_select_country_and_title");case"emptyCountryTypeInput":return s("please_select_country_and_type");case"emptyTitleTypeInput":return s("please_enter_title_and_type");case"emptyCountryInput":return s("please_select_a_country");case"emptyTitleInput":return s("please_input_title_name");case"emptyTypeInput":return s("please_input_title_type");case"titleExists":return s("title_already_exists");case"titleAddedSuccessfully":return s("title_added_successfully");case"error":return s("error_submitting_form");default:return""}});V(async()=>{await y.fetchCountries(),await d.fetchTitles()});const T=async()=>{if(!e.country_id&&!e.title&&!e.title_type){i.value="emptyInput",l.value=!0;return}else if(!e.country_id&&!e.title){i.value="emptyCountryTitleInput",l.value=!0;return}else if(!e.country_id&&!e.title_type){i.value="emptyCountryTypeInput",l.value=!0;return}else if(!e.title&&!e.title_type){i.value="emptyTitleTypeInput",l.value=!0;return}else if(e.country_id)if(e.title){if(!e.title_type){i.value="emptyTypeInput",l.value=!0;return}}else{i.value="emptyTitleInput",l.value=!0;return}else{i.value="emptyCountryInput",l.value=!0;return}const m=n=>n.normalize("NFD").replace(/[\u0300-\u036f]/g,""),o=e.title.toLocaleUpperCase();if(g.value.some(n=>{const k=m(n.title.toLocaleUpperCase()),w=n.country_id===e.country_id;return k===o&&w}))i.value="titleExists",l.value=!0;else try{const n=await D.post("/api/add-foreign-title",e);i.value="titleAddedSuccessfully",l.value=!0,e.title="",e.title_type="",e.info="",d.addTitle(n.data),d.broadcastUpdate(n.data)}catch(n){console.error("Υπήρξε ένα σφάλμα στην αποστολή της φόρμας",n),i.value="error",l.value=!0}};return(m,o)=>(S(),U("div",B,[t("div",j,[t("div",F,[t("div",null,[L,b(" "+a(u(s)("add_title_form_add_title")),1)])]),t("form",{onSubmit:N(T,["prevent"]),class:"flex flex-col justify-center gap-3 w-full px-3"},[q,t("div",P,[t("label",$,a(u(s)("add_title_form_country")),1),v(A,{id:"country_id_title",options:x.value,"option-value":"id","option-text":"country",modelValue:e.country_id,"onUpdate:modelValue":o[0]||(o[0]=r=>e.country_id=r),placeholder:u(s)("choose_country"),required:""},null,8,["options","modelValue","placeholder"])]),t("div",G,[t("label",H,a(u(s)("add_title_form_title")),1),p(t("input",{id:"title","onUpdate:modelValue":o[1]||(o[1]=r=>e.title=r),type:"text",class:"mt-1 block w-full py-2 px-3 text-blue-950 border border-sky-400 bg-gray-200 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500"},null,512),[[_,e.title]])]),t("div",J,[t("label",K,a(u(s)("add_title_form_title_type")),1),p(t("input",{id:"title_type","onUpdate:modelValue":o[2]||(o[2]=r=>e.title_type=r),type:"text",class:"mt-1 block w-full py-2 px-3 text-blue-950 border border-sky-400 bg-gray-200 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500"},null,512),[[_,e.title_type]])]),t("div",O,[t("label",Q,a(u(s)("add_title_form_information")),1),p(t("input",{id:"info_title","onUpdate:modelValue":o[3]||(o[3]=r=>e.info=r),type:"text",class:"mt-1 block w-full py-2 px-3 text-blue-950 border border-sky-400 bg-gray-200 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500"},null,512),[[_,e.info]])]),t("button",R,[W,b(" "+a(u(s)("save")),1)])],32)]),v(z,{message:h.value,isVisible:l.value,"onUpdate:isVisible":o[4]||(o[4]=r=>l.value=r)},null,8,["message","isVisible"])]))}};export{se as default};
