import{a as v,D as O,k as p,B as V,r as y,l as U,d as C,e as E,f as s,p as $,t as u,h as S,g as I,x as l,y as r,C as N}from"./app-C4nfOcqx.js";import{a as M,u as q}from"./countriesStore-DlzkWG2V.js";import{C as B}from"./CustomDropdown-iE1I-pk4.js";import{_ as D}from"./Popup-BAEILLfG.js";const j={class:"flex justify-center mt-12 text-blue-950"},F={class:"flex flex-col justify-center items-center bg-[#c4dff6] rounded-xl p-3 mt-28 border-2 border-sky-400 max-w-2xl w-full"},T={class:"flex flex-wraptext-gray-700 mt-2 self-start px-3"},P=s("i",{class:"fas fa-info-circle",style:{"margin-right":"0.5rem"}},null,-1),R=s("hr",{class:"border-t border-white w-full my-4 px-3"},null,-1),z={class:"mb-4"},A={for:"new_country_id",class:"block text-sm font-medium mb-1"},G={class:"mb-4 w-full"},H={for:"new_institute",class:"block text-sm font-medium"},J={class:"mb-4 w-full"},K={for:"new_institute_original",class:"block text-sm font-medium"},L={class:"mb-4 w-full"},Q={for:"new_institute_el",class:"block text-sm font-medium"},W={class:"mb-4 w-full"},X={for:"new_institute_old_1",class:"block text-sm font-medium"},Y={class:"mb-4 w-full"},Z={for:"new_institute_old_2",class:"block text-sm font-medium"},tt={class:"mb-4 w-full"},et={for:"new_url",class:"block text-sm font-medium"},st={class:"mb-4 w-full"},nt={for:"info",class:"block text-sm font-medium"},it={class:"mb-6 self-center"},ot={for:"franchise",class:"flex items-center"},ut={class:"ml-2 text-sm"},ft={__name:"ViewInstitute",setup(lt){const{t:a}=v(),c=O(),m=M(),d=q(),g=p(()=>m.countries),t=V({institute_id:Number(c.params.id),newCountryId:Number(c.query.country),newInstitute:c.query.institute,newUrl:"",newInstituteOriginal:"",newInstituteEl:"",newInstituteOld1:"",newInstituteOld2:"",info:c.query.info,franchise:c.query.franchise==="1"}),w=y(!1),b=y(null),x=p(()=>{switch(b.value){case"emptyInstituteInput":return a("please_input_institite_name");case"sameInstituteInput":return a("same_institute_already_exists");case"details_updated_successfully":return a("details_updated_successfully");case"problem_updating_details":return a("error_submitting_form");case"error":return a("error_submitting_form");default:return""}});U(async()=>{m.fetchCountries(),await d.fetchInstitutes();const n=d.institutes.filter(e=>e.country_id===t.newCountryId&&e.institute===t.newInstitute)[0];console.log(n),n&&(t.newUrl=n.url,t.newInstituteOriginal=n.institute_original,t.newInstituteEl=n.institute_el,t.newInstituteOld1=n.institute_old_1,t.newInstituteOld2=n.institute_old_2)});const k=async()=>{if(d.institutes.filter(i=>i.country_id===t.newCountryId).some(i=>i.institute===t.newInstitute&&i.franchise==t.franchise&&i.info===t.info&&i.url===t.newUrl&&i.institute_original===t.newInstituteOriginal&&i.institute_el===t.newInstituteEl&&i.institute_old_1===t.newInstituteOld1&&i.institute_old_2===t.newInstituteOld2)){f("sameInstituteInput");return}const e={};if(t.newCountryId&&(e.newCountryId=t.newCountryId),t.newInstitute)e.newInstitute=t.newInstitute;else if(t.newInstitute=""){f("emptyInstituteInput");return}t.info?e.info=t.info:t.info||(e.info=""),e.newUrl=t.newUrl?t.newUrl:"",e.newInstituteOriginal=t.newInstituteOriginal?t.newInstituteOriginal:"",e.newInstituteEl=t.newInstituteEl?t.newInstituteEl:"",e.newInstituteOld1=t.newInstituteOld1?t.newInstituteOld1:"",e.newInstituteOld2=t.newInstituteOld2?t.newInstituteOld2:"",console.log(t.info),e.franchise=t.franchise;try{const i=await d.editInstitute(t,e);if(i&&i.status===200){const _=i.data,h=m.getCountryNameById(_.country_id);_.country=h,d.updateInstitute(_),d.broadcastEdit(_),f("details_updated_successfully")}else f("problem_updating_details")}catch(i){console.error("Υπήρξε σφάλμα στην αποστολή της φόρμας",i),f("error")}},f=o=>{b.value=o,w.value=!0};return(o,n)=>(C(),E("div",j,[s("div",F,[s("div",T,[s("div",null,[P,$(" "+u(o.$t("view_institute_details")),1)])]),s("form",{onSubmit:S(k,["prevent"]),class:"flex flex-col justify-center gap-3 w-full px-3"},[R,s("div",z,[s("label",A,u(o.$t("add_institute_form_country")),1),I(B,{id:"new_country_id",options:g.value,"option-value":"id","option-text":"country",modelValue:t.newCountryId,"onUpdate:modelValue":n[0]||(n[0]=e=>t.newCountryId=e),placeholder:o.$t("choose_country"),"read-only":"true",required:""},null,8,["options","modelValue","placeholder"])]),s("div",G,[s("label",H,u(o.$t("add_institute_form_institute")),1),l(s("input",{id:"new_institute","onUpdate:modelValue":n[1]||(n[1]=e=>t.newInstitute=e),type:"text",class:"mt-1 block w-full py-2 px-3 text-blue-950 border border-sky-400 bg-gray-200 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500",disabled:"true"},null,512),[[r,t.newInstitute]])]),s("div",J,[s("label",K,u(o.$t("add_institute_form_institute_original")),1),l(s("input",{id:"new_institute_original","onUpdate:modelValue":n[2]||(n[2]=e=>t.newInstituteOriginal=e),type:"text",class:"mt-1 block w-full py-2 px-3 text-blue-950 border border-sky-400 bg-gray-200 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500",disabled:"true"},null,512),[[r,t.newInstituteOriginal]])]),s("div",L,[s("label",Q,u(o.$t("add_institute_form_institute_el")),1),l(s("input",{id:"new_institute_el","onUpdate:modelValue":n[3]||(n[3]=e=>t.newInstituteEl=e),type:"text",class:"mt-1 block w-full py-2 px-3 text-blue-950 border border-sky-400 bg-gray-200 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500",disabled:"true"},null,512),[[r,t.newInstituteEl]])]),s("div",W,[s("label",X,u(o.$t("add_institute_form_institute_old_institute_1")),1),l(s("input",{id:"new_institute_old_1","onUpdate:modelValue":n[4]||(n[4]=e=>t.newInstituteOld1=e),type:"text",class:"mt-1 block w-full py-2 px-3 text-blue-950 border border-sky-400 bg-gray-200 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500",disabled:"true"},null,512),[[r,t.newInstituteOld1]])]),s("div",Y,[s("label",Z,u(o.$t("add_institute_form_institute_old_institute_2")),1),l(s("input",{id:"new_institute_old_2","onUpdate:modelValue":n[5]||(n[5]=e=>t.newInstituteOld2=e),type:"text",class:"mt-1 block w-full py-2 px-3 text-blue-950 border border-sky-400 bg-gray-200 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500",disabled:"true"},null,512),[[r,t.newInstituteOld2]])]),s("div",tt,[s("label",et,u(o.$t("add_institute_form_institute_url")),1),l(s("input",{id:"new_url","onUpdate:modelValue":n[6]||(n[6]=e=>t.newUrl=e),type:"text",class:"mt-1 block w-full py-2 px-3 text-blue-950 border border-sky-400 bg-gray-200 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500",disabled:"true"},null,512),[[r,t.newUrl]])]),s("div",st,[s("label",nt,u(o.$t("add_institute_form_information")),1),l(s("input",{id:"info","onUpdate:modelValue":n[7]||(n[7]=e=>t.info=e),type:"text",class:"mt-1 block w-full py-2 px-3 text-blue-950 border border-sky-400 bg-gray-200 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-gray-500",disabled:"true"},null,512),[[r,t.info]])]),s("div",it,[s("label",ot,[l(s("input",{id:"franchise","onUpdate:modelValue":n[8]||(n[8]=e=>t.franchise=e),type:"checkbox",class:"h-4 w-4 rounded",disabled:"true"},null,512),[[N,t.franchise]]),s("span",ut,u(o.$t("add_institute_form_franchise")),1)])])],32)]),I(D,{message:x.value,isVisible:w.value,"onUpdate:isVisible":n[9]||(n[9]=e=>w.value=e)},null,8,["message","isVisible"])]))}};export{ft as default};
